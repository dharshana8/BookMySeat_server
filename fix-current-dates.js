import mongoose from 'mongoose';\nimport Bus from './Model/Busmodel.js';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nconst MONGO_URI = process.env.MONGO_URI || 'mongodb://localhost:27017/bus_tbooking';\n\nasync function fixBusDates() {\n  try {\n    await mongoose.connect(MONGO_URI);\n    console.log('üîÑ Fixing bus dates to current dates...');\n    \n    const buses = await Bus.find();\n    console.log(`Found ${buses.length} buses to update`);\n    \n    const now = new Date();\n    let updated = 0;\n    \n    for (const bus of buses) {\n      // Extract time from original departure\n      const originalDeparture = new Date(bus.departure);\n      const hours = originalDeparture.getHours();\n      const minutes = originalDeparture.getMinutes();\n      \n      // Calculate which day this bus should be (based on original date)\n      const originalDate = new Date(originalDeparture);\n      originalDate.setHours(0, 0, 0, 0);\n      \n      const baseDate = new Date('2024-01-01');\n      baseDate.setHours(0, 0, 0, 0);\n      \n      const daysDiff = Math.floor((originalDate - baseDate) / (1000 * 60 * 60 * 24));\n      \n      // Set new date starting from today\n      const newDate = new Date();\n      newDate.setDate(newDate.getDate() + (daysDiff % 365));\n      \n      // Create new departure with correct date and time\n      const newDeparture = new Date(newDate);\n      newDeparture.setHours(hours, minutes, 0, 0);\n      \n      // Calculate duration from original bus\n      const originalDuration = new Date(bus.arrival) - new Date(bus.departure);\n      const newArrival = new Date(newDeparture.getTime() + originalDuration);\n      \n      // Update bus\n      bus.departure = newDeparture;\n      bus.arrival = newArrival;\n      \n      // Add ID if missing\n      if (!bus.id) {\n        bus.id = `BUS-${newDeparture.getTime()}-${Math.random().toString(36).substr(2, 5)}`;\n      }\n      \n      await bus.save();\n      updated++;\n      \n      if (updated % 100 === 0) {\n        console.log(`Updated ${updated}/${buses.length} buses...`);\n      }\n    }\n    \n    console.log(`‚úÖ Updated ${updated} buses with current dates`);\n    \n    // Show sample of updated buses\n    const sample = await Bus.find().limit(3);\n    console.log('Sample updated buses:');\n    sample.forEach(bus => {\n      console.log(`${bus.name}: ${bus.departure.toLocaleString()} -> ${bus.arrival.toLocaleString()}`);\n    });\n    \n    process.exit(0);\n  } catch (error) {\n    console.error('‚ùå Error:', error);\n    process.exit(1);\n  }\n}\n\nfixBusDates();